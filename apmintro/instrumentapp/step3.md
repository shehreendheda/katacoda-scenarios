The `store-frontend` service has a Ruby-on-Rails framework. The first step for instrumentation is to install the required Ruby tracing and log collection libraries. Next, an initializer file is added to enable Rails instrumentation. A configuration file is also added to ship logs to Datadog in JSON format so that Datadog can filter the logs based on special parameters. Finally, the docker-compose.yml is updated to enable trace injection, log injections and App Analytics for the frontend service. 

1. Click `store-frontend/Gemfile`{{open}} to view the Gemfile for the store-frontend. The Gemfile installs the required tracing and log collection libraries.<p> **Line 46** installs the `ddtrace` Gem, which is <a href="https://docs.datadoghq.com/tracing/setup/ruby/" target="_blank">Datadogâ€™s tracing client for Ruby</a>. The `ddtrace` library traces requests as they flow across web servers, databases, and microservices so that developers have high visibility into bottlenecks and troublesome requests. <p>**Line 48** installs the `logging-rails` Gem, which is a railtie for integrating the Ruby logging framework into the Rails application. To learn more, view the <a href="https://github.com/TwP/logging-rails" target="_blank">logging-rails</a> documentation. <p>**Line 49** installs the `lograge` Gem to send logs to Datadog. To learn more, view the <a href="https://docs.datadoghq.com/logs/log_collection/ruby/#setup" target="_blank">Ruby on Rails log collection</a> documentation.


2. Click `store-frontend/config/initializers/datadog.rb`{{open}} to view the initializer file that enables Rails instrumentation. <p>**Line 3** activates autoinstrumentation for Rails. You can view the definitions of each option in the <a href="https://docs.datadoghq.com/tracing/setup/ruby/#rails" target="_blank">Tracing Ruby Applications - Integration Instrumenation - Rails</a> documentation. <p>**Line 5** makes sure requests are also instrumented. You can view the definitions of each option in the <a href="https://docs.datadoghq.com/tracing/setup/ruby/#net-http" target="_blank">Tracing Ruby Applications - Integration Instrumenation - Net/HTTP</a> documentation. <p>**Line 6** allows you to update the default behavior of the Datadog tracer. You can view the definitions of each option in the <a href="https://docs.datadoghq.com/tracing/setup/ruby/#advanced-configuration" target="_blank">Tracing Ruby Applications - Advanced Configuration - Tracer Settings</a> documentation.

3. Click `store-frontend/config/environments/development.rb`{{open}} to view the configuration file that converts the logs to the JSON format using **Lines 11-28**. To learn more, view the <a href="https://docs.datadoghq.com/tracing/connect_logs_and_traces/ruby/?tab=lograge#automatic-trace-id-injection" target="_blank">Connecting Ruby Logs and Traces</a> documentation. 

4. Click `docker-compose.yml`{{open}}. <p>**Line 43** defines the address of the Agent that the tracer submits to. <p>**Line 44** enables automatic injection of trace IDs into the logs from the supported logging libraries to correlate traces and logs. <p>**Line 45** enables App Analytics for the traces.<p> **Lines 59 and 60** allow Datadog to identify the log source for the container and automatically install the corresponding integration.

With these steps, the Ruby-on-Rails `store-frontend` service is instrumented for APM with Datadog. Now let's go over instrumentation for the Python-based services of the app.